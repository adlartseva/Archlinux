##############################################
## Базовая установка Archlinux для Ноутбука ##
##############################################

# dd bs=4M if=archlinux-2016-05-01.iso of=/dev/sdx status=progress && sync  # записываем Archlinux на флэшку из под linux, с возможностью отслеживать статус записи

################
## Установка ##
################

# setfont iso02-12x22  # делаем шрифт крупнее

# wifi-menu  # поключениек интернету через wifi

# pacman -Syy  # синхронизация базы данных

# pacman -S reflector  # устанавливаем рефлектор (скрипт, который автоматизирует процесс настройки зеркал) 

# cp -vf /etc/pacman.d/mirrorlist /etc/pacman.d/mirrorlist.backup  # сделаем резервную копию файла mirrorlist

# reflector --verbose -l 200 -p http --sort rate --save /etc/pacman.d/mirrorlist  # отсортирует зеркала по скорости и обновит mirrorlist

# lsblk  # проверяем разделы диска

# parted /dev/sda  # перезозданим таблицу разделов

(parted) mklabel gpt  # создаем таблицу gpt

(parted) mkpart ESP fat32 1M 513M  # создаем системный раздел для EFI

(parted) set 1 boot on  # сделать загрузочным

(parted) mkpart primary ext4 513M 50G  # создаем раздел для корневой директории

(parted) mkpart primary ext4 50G 100%  # создаем раздел для домашней директории

(parted) exit  # выходим из разметки

# mkfs.vfat -F32 /dev/sda1  # форматируем раздел boot

# mkfs.ext4 /dev/sda2 -L root  # форматируем раздел под корневой раздел

# mkfs.ext4 /dev/sda3 -L home  # форматируем раздел под домашнюю директорию

# mount /dev/sda2 /mnt  # монтируем корневой раздел

# mkdir /mnt/boot  # создаем директорию для boot

# mkdir /mnt/home  # создаем директорию для домашней директории

# mount /dev/sda1 /mnt/boot  # монтируем boot

# mount /dev/sda3 /mnt/home  # монтируем домашнюю директорию

# pacstrap /mnt base base-devel  # устанавливаем нашу систему

# genfstab -U /mnt >> /mnt/etc/fstab  # генерируем fstab

# cat /mnt/etc/fstab  # проверяем

# arch-chroot /mnt  # переключаемся в установленную систему

sh-4.3# passwd  # задаем пароль для суперпользователя

sh-4.3# pacman -S iw wpa_supplicant dialog  # пакеты для работоспособности wifi

sh-4.3# mkinitcpio -p linux  # обновляем загрузочный RAM диск

sh-4.3# bootctl install  # устанавливаем загрузчик для UEFI

sh-4.3# nano /boot/loader/loader.conf  # изменяем автозагрузку для UEFI

     default  arch
     timeout 0

sh-4.3# nano /boot/loader/entries/arch.conf  # создаем ярлык для системы     

     title  Arch Linux
     linux  /vmlinuz-linux
     initrd  /initramfs-linux.img
     options  root:/dev/sda2 rw

sh-4.3# exit  # выходим из установленной системы

# umount /mnt -R  # отмонтируем все разделы жесткого диска

# reboot  # перезагрузка     
